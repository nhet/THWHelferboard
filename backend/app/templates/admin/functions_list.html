
{% extends 'admin/base.html' %}
{% block admin_content %}
<h2>Funktionen</h2>
<div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;">
  <a class="btn" href="/admin/functions/new">+ Neue Funktion</a>
  <form action="/admin/functions/import" method="post" enctype="multipart/form-data" onsubmit="return confirm('Bestehende Funktionen mit gleicher ID werden überschrieben. Fortfahren?')">
    <label for="csv_file">CSV-Import (id,Bezeichnung):</label>
    <input type="file" id="csv_file" name="csv_file" accept=".csv" required>
    <button type="submit" class="btn">Importieren</button>
  </form>
</div>
<div class="table-toolbar" style="margin-bottom:0.5rem; display:flex; gap:8px; align-items:center;">
  <div class="table-filter-wrapper">
    <input class="table-filter" placeholder="Filter (alle Spalten)" aria-label="Filter Funktionen" />
    <button type="button" class="table-filter-reset hidden" aria-label="Filter zurücksetzen" title="Filter zurücksetzen">✖</button>
  </div>
    Einträge: ( <p id="filtertedItems">{{ functions|length }}</p> / {{ functions|length }} )
</div>
<table class="list-table">
  <thead>
    <tr><th>#</th><th>Bezeichnung</th><th>Kurz</th><th>Legendenbezeichnung</th><th>Sortierung</th><th>Emblem</th><th class="no-sort">Aktionen</th></tr>
  </thead>
  <tbody>
    {% for f in functions %}
      <tr data-href="/admin/functions/{{ f.id }}" tabindex="0">
        <td>{{ f.id }}</td>
        <td>{{ f.name }}</td>
        <td>{{ f.short_name or '-' }}</td>
        <td>{{ f.legend_name or '-' }}</td>
        <td>{{ f.sort_order }}</td>
        <td>{% if f.emblem_svg_path %}<img src="{{ url_for('static', path=f.emblem_svg_path) }}" style="height:24px"/>{% else %}-{% endif %}</td>
        <td>
          <a class="btn" href="/admin/functions/{{ f.id }}">Bearbeiten</a>
          <form method="post" action="/admin/functions/{{ f.id }}/delete" style="display:inline" onsubmit="return confirm('Löschen?')">
            <button class="btn danger" type="submit">Löschen</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
