
{% extends 'admin/base.html' %}
{% block admin_content %}
<h2>Gruppen</h2>
<div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;">
    <a class="btn" href="/admin/groups/new">+ Neue Gruppe</a>
    <form action="/admin/groups/import" method="post" enctype="multipart/form-data" onsubmit="return confirm('Bestehende Gruppen mit gleicher ID werden überschrieben. Fortfahren?')">
        <label for="csv_file">CSV-Import (ID,Bezeichnung,parentId):</label>
        <input type="file" id="csv_file" name="csv_file" accept=".csv" required>
        <button type="submit" class="btn">Importieren</button>
    </form>
</div>
<div class="table-toolbar" style="margin-bottom:0.5rem; display:flex; gap:8px; align-items:center;">
  <div class="table-filter-wrapper">
    <input class="table-filter" placeholder="Filter (alle Spalten)" aria-label="Filter Gruppen" />
    <button type="button" class="table-filter-reset hidden" aria-label="Filter zurücksetzen" title="Filter zurücksetzen">✖</button>
  </div>
    Einträge: ( <p id="filtertedItems">{{ groups|length }}</p> / {{ groups|length }} )
</div>
<table class="list-table">
  <thead>
    <tr><th>ID</th><th>Bezeichnung</th><th>Übergeordnet</th><th>Sortierung</th><th>Detailseite</th><th class="no-sort">Aktionen</th></tr>
  </thead>
  <tbody>
    {% for g in groups %}
      <tr data-href="/admin/groups/{{ g.id }}" tabindex="0">
        <td>{{ g.id }}</td>
        <td>{{ g.name }}</td>
        <td>{{ g.parent.name if g.parent else '-' }}</td>
        <td>{{ g.sort_order }}</td>
        <td>{{g.detail_enabled}}</td>
        <td>
          <a class="btn" href="/admin/groups/{{ g.id }}">Bearbeiten</a>
          <form method="post" action="/admin/groups/{{ g.id }}/delete" style="display:inline" onsubmit="return confirm('Löschen?')">
            <button class="btn danger" type="submit">Löschen</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
